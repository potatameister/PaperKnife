import{j as e,a as b}from"./index-C25k4DUI.js";import{r as t,X as h,U as g,ac as j,E as m}from"./vendor-ui-BR-XW_se.js";import{P as y}from"./pdf-lib-core-B0uti0Qf.js";import{S as N}from"./SuccessState-D_JgGa0o.js";import{N as v,P as w}from"./NativeToolLayout-Dlo0QEPa.js";import"./pdfjs-viewer-BENO9Ct1.js";function z(){const o=t.useRef(null),[s,i]=t.useState(!1),[l,n]=t.useState(null),[p,u]=t.useState(""),f=async r=>{if(r.type==="application/pdf"){i(!0),u(r.name);try{const a=await r.arrayBuffer(),x=await(await y.load(a,{ignoreEncryption:!0,throwOnInvalidObject:!1})).save(),c=new Blob([x],{type:"application/pdf"}),d=URL.createObjectURL(c);n(d),b({name:`repaired-${r.name}`,tool:"Repair",size:c.size,resultUrl:d}),m.success("PDF rebuilt successfully!")}catch(a){m.error(`Error: ${a.message}`)}finally{i(!1)}}};return e.jsxs(v,{title:"Repair PDF",description:"Fix corrupted or unreadable PDF files by rebuilding structure.",children:[e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:o,onChange:r=>r.target.files?.[0]&&f(r.target.files[0])}),l?e.jsx(N,{message:"Reconstruction Complete!",downloadUrl:l,fileName:`repaired-${p}`,onStartOver:()=>n(null)}):e.jsx("div",{onClick:()=>!s&&o.current?.click(),className:`border-4 border-dashed border-gray-100 dark:border-zinc-900 rounded-[2.5rem] p-12 text-center hover:bg-rose-50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group ${s?"opacity-50":""}`,children:s?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(h,{size:48,className:"text-rose-500 animate-spin mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Rebuilding..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-rose-50 dark:bg-rose-900/20 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(g,{size:32})}),e.jsx("h3",{className:"text-xl font-bold dark:text-white mb-2",children:"Select Corrupted PDF"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to upload and attempt repair"})]})}),e.jsxs("div",{className:"mt-8 p-6 bg-amber-50 dark:bg-amber-900/10 rounded-2xl border border-amber-100 dark:border-white/5 flex items-start gap-4",children:[e.jsx(j,{className:"text-amber-500 shrink-0",size:20}),e.jsxs("div",{className:"text-xs text-amber-700 dark:text-amber-400 leading-relaxed",children:[e.jsx("p",{className:"font-bold mb-1 uppercase tracking-widest",children:"How it works:"}),"PaperKnife generates a fresh Cross-Reference Table. This can fix files that refuse to open. Highly corrupted files may still fail."]})]}),e.jsx(w,{})]})}export{z as default};
