import{g as s,G as f}from"./pdfjs-viewer-BENO9Ct1.js";const g="/PaperKnife/assets/pdf.worker.min-LyOxJPrg.mjs";f.workerSrc=g;const m=async o=>{const a=await o.arrayBuffer();try{return await s({data:a,cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0}).promise}catch(t){if(t.name==="PasswordException")throw t;return await s({data:a,cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0,stopAtErrors:!1}).promise}},l=async(o,a,t=1)=>{try{const e=await o.getPage(a),n=e.getViewport({scale:t}),c=300,p=Math.min(c/n.width,c/n.height),d=e.getViewport({scale:t*p*(window.devicePixelRatio||1)}),r=document.createElement("canvas"),i=r.getContext("2d",{alpha:!1});if(!i)throw new Error("Canvas context not available");r.height=d.height,r.width=d.width,i.fillStyle="#ffffff",i.fillRect(0,0,r.width,r.height),await e.render({canvasContext:i,viewport:d,intent:"display"}).promise;const u=r.toDataURL("image/jpeg",.85);return r.width=0,r.height=0,u}catch(e){return console.error(`Error rendering page ${a}:`,e),""}},h=async o=>{try{const a=s({data:await o.arrayBuffer(),cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0});a.onPassword=()=>{throw new Error("PASSWORD_REQUIRED")};const t=await a.promise;return{thumbnail:await l(t,1),pageCount:t.numPages,isLocked:!1}}catch(a){return a.message==="PASSWORD_REQUIRED"||a.name==="PasswordException"?{thumbnail:"",pageCount:0,isLocked:!0}:{thumbnail:"",pageCount:0,isLocked:!1}}},P=async(o,a)=>{try{const t=await o.arrayBuffer(),n=await s({data:t,password:a,cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0}).promise;return{thumbnail:await l(n,1),pageCount:n.numPages,isLocked:!1,success:!0,pdfDoc:n}}catch{return{thumbnail:"",pageCount:0,isLocked:!0,success:!1}}};export{h as g,m as l,l as r,P as u};
