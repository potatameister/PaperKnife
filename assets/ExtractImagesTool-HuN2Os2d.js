import{C as B,j as e,a as O}from"./index-CwQWfSva.js";import{r as o,a6 as L,l as M,a0 as J,G as p,Y as Z,ad as q}from"./vendor-ui-Bs56Vaqo.js";import{J as G}from"./vendor-utils-CHNdyjGA.js";import{P as W,u as X,g as Y,l as _}from"./PrivacyBadge-DtnXHkrx.js";import{S as H}from"./SuccessState-D432dsD-.js";import{N as K}from"./NativeToolLayout-CBoOIgYn.js";import"./tesseract-core-CiwplfBU.js";import"./pdfjs-viewer-BENO9Ct1.js";function ie(){const P=o.useRef(null),[a,l]=o.useState(null),[c,n]=o.useState(!1),[I,f]=o.useState(0),[h,b]=o.useState(null),[U,j]=o.useState(0),[w,y]=o.useState("extracted-images"),[i,E]=o.useState(""),C=B.isNativePlatform(),$=async()=>{if(!a||!i)return;n(!0);const t=await X(a.file,i);t.success?(l({...a,isLocked:!1,pageCount:t.pageCount,pdfDoc:t.pdfDoc,thumbnail:t.thumbnail,password:i}),y(`${a.file.name.replace(".pdf","")}-extracted`)):p.error("Incorrect password"),n(!1)},R=async t=>{if(t.type==="application/pdf"){n(!0);try{const s=await Y(t);if(s.isLocked)l({file:t,pageCount:0,isLocked:!0});else{const d=await _(t);l({file:t,pageCount:s.pageCount,isLocked:!1,pdfDoc:d,thumbnail:s.thumbnail}),y(`${t.name.replace(".pdf","")}-extracted`)}}catch(s){console.error(s)}finally{n(!1),b(null)}}},A=async()=>{if(!(!a||!a.pdfDoc)){n(!0),f(0),j(0),await new Promise(t=>setTimeout(t,100));try{const t=new G;let s=0;for(let m=1;m<=a.pageCount;m++){const S=await a.pdfDoc.getPage(m),k=await S.getOperatorList();for(let u=0;u<k.fnArray.length;u++){const x=k.fnArray[u],v=k.argsArray[u]?.[0];if(typeof v=="string"&&v.startsWith("img_"))try{const r=await S.objs.get(v);if(r&&r.data){s++;const g=document.createElement("canvas");g.width=r.width,g.height=r.height;const N=g.getContext("2d");if(N){const F=N.createImageData(r.width,r.height);F.data.set(r.data),N.putImageData(F,0,0);const T=g.toDataURL("image/png").split(",")[1];t.file(`image-${s.toString().padStart(3,"0")}.png`,T,{base64:!0})}}}catch(r){console.warn("Failed to extract an image object",r)}}f(Math.round(m/a.pageCount*100)),j(s)}if(s===0){p.error("No embedded images found in this PDF."),n(!1);return}const d=await t.generateAsync({type:"blob"}),z=URL.createObjectURL(d);b(z),O({name:`${w}.zip`,tool:"Extract Images",size:d.size,resultUrl:z}),p.success(`Extracted ${s} images!`)}catch(t){p.error(`Error: ${t.message}`)}finally{n(!1)}}},D=()=>e.jsx("button",{onClick:A,disabled:c,className:`w-full bg-rose-500 hover:bg-rose-600 text-white font-black uppercase tracking-widest transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3 shadow-xl shadow-rose-500/20 ${C?"py-4 rounded-2xl text-sm":"p-6 rounded-3xl text-xl"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"animate-spin"})," ",I,"%"]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{size:18})," Extract Raw Images"]})});return e.jsxs(K,{title:"Extract Images",description:"Find and save all original images embedded inside the PDF.",actions:a&&!a.isLocked&&!h&&e.jsx(D,{}),children:[e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:P,onChange:t=>t.target.files?.[0]&&R(t.target.files[0])}),a?a.isLocked?e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-white/5 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(M,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"Protected File"}),e.jsx("input",{type:"password",value:i,onChange:t=>E(t.target.value),placeholder:"Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-transparent focus:border-rose-500 outline-none font-bold text-center mb-4"}),e.jsx("button",{onClick:$,disabled:!i||c,className:"w-full bg-rose-500 text-white p-4 rounded-2xl font-black uppercase text-xs",children:"Unlock"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-3xl border border-gray-100 dark:border-white/5 flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-20 bg-gray-50 dark:bg-black rounded-xl overflow-hidden shrink-0 border border-gray-100 dark:border-zinc-800 flex items-center justify-center text-rose-500",children:a.thumbnail?e.jsx("img",{src:a.thumbnail,className:"w-full h-full object-cover"}):e.jsx(L,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-sm truncate dark:text-white",children:a.file.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 uppercase font-black",children:[a.pageCount," Pages â€¢ ",(a.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsx("button",{onClick:()=>l(null),className:"p-2 text-gray-400 hover:text-rose-500 transition-colors",children:e.jsx(J,{size:20})})]}),e.jsx("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-white/5 space-y-8",children:h?e.jsx(H,{message:`Successfully extracted ${U} images!`,downloadUrl:h,fileName:`${w}.zip`,onStartOver:()=>{b(null),f(0),j(0)},showPreview:!1}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 leading-relaxed",children:"This tool will scan every page of your PDF and pull out the high-quality source images. Perfect for saving photos from documents."})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase text-gray-400 mb-3",children:"ZIP Filename"}),e.jsx("input",{type:"text",value:w,onChange:t=>y(t.target.value),className:"w-full bg-gray-50 dark:bg-black rounded-xl px-4 py-3 border border-transparent focus:border-rose-500 outline-none font-bold text-sm"})]}),!C&&e.jsx(D,{})]})})]}):e.jsxs("div",{onClick:()=>!c&&P.current?.click(),className:"border-4 border-dashed border-gray-100 dark:border-zinc-900 rounded-[2.5rem] p-12 text-center hover:bg-rose-50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group",children:[e.jsx("div",{className:"w-20 h-20 bg-rose-50 dark:bg-rose-900/20 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(L,{size:32})}),e.jsx("h3",{className:"text-xl font-bold dark:text-white mb-2",children:"Select PDF"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to search for images"})]}),e.jsx(W,{})]})}export{ie as default};
