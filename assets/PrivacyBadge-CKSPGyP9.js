const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-BjIlosdi.js","assets/index-DUUuY0BK.js","assets/vendor-ui-BlqHMN4k.js","assets/index-uakxTiQm.css"])))=>i.map(i=>d[i]);
import{g as c,G as m}from"./pdfjs-viewer-BENO9Ct1.js";import{r as b,_ as P,C as p,F as f,D as h,j as u}from"./index-DUUuY0BK.js";const y=b("Share",{web:()=>P(()=>import("./web-BjIlosdi.js"),__vite__mapDeps([0,1,2,3])).then(e=>new e.ShareWeb)}),k="/PaperKnife/assets/pdf.worker.min-LyOxJPrg.mjs";m.workerSrc=k;const v=async(e,t,a)=>{if(p.isNativePlatform())try{const r=typeof e=="string"?e.split(",")[1]:btoa(e.reduce((o,n)=>o+String.fromCharCode(n),""));return await f.writeFile({path:t,data:r,directory:h.Documents,recursive:!0}),!0}catch(r){throw console.error("Download error:",r),r}else{const r=typeof e=="string"?await(await fetch(e)).blob():new Blob([e],{type:a}),o=URL.createObjectURL(r),n=document.createElement("a");return n.href=o,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o),!0}},D=async(e,t,a)=>{if(p.isNativePlatform())try{const r=typeof e=="string"?e.split(",")[1]:btoa(e.reduce((n,l)=>n+String.fromCharCode(l),"")),o=await f.writeFile({path:t,data:r,directory:h.Cache,recursive:!0});return await y.share({title:t,text:"Shared via PaperKnife",url:o.uri,dialogTitle:"Share PDF"}),!0}catch(r){throw console.error("Share error:",r),r}else{const r=typeof e=="string"?await(await fetch(e)).blob():new Blob([e],{type:a}),o=new File([r],t,{type:a});if(navigator.share&&navigator.canShare?.({files:[o]}))try{return await navigator.share({files:[o],title:t,text:"Shared via PaperKnife"}),!0}catch{console.error("Web share failed, falling back to download")}return v(e,t,a)}},S=async e=>{const t=await e.arrayBuffer();try{return await c({data:t,cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0}).promise}catch(a){if(a.name==="PasswordException")throw a;return await c({data:t,cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0,stopAtErrors:!1}).promise}},w=async(e,t,a=1)=>{try{const r=await e.getPage(t),o=r.getViewport({scale:a}),n=300,l=Math.min(n/o.width,n/o.height),d=r.getViewport({scale:a*l*(window.devicePixelRatio||1)}),i=document.createElement("canvas"),s=i.getContext("2d",{alpha:!1});if(!s)throw new Error("Canvas context not available");i.height=d.height,i.width=d.width,s.fillStyle="#ffffff",s.fillRect(0,0,i.width,i.height),await r.render({canvasContext:s,viewport:d,intent:"display"}).promise;const g=i.toDataURL("image/jpeg",.85);return i.width=0,i.height=0,g}catch(r){return console.error(`Error rendering page ${t}:`,r),""}},E=async e=>{try{const t=c({data:await e.arrayBuffer(),cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0});t.onPassword=()=>{throw new Error("PASSWORD_REQUIRED")};const a=await t.promise;return{thumbnail:await w(a,1),pageCount:a.numPages,isLocked:!1}}catch(t){return t.message==="PASSWORD_REQUIRED"||t.name==="PasswordException"?{thumbnail:"",pageCount:0,isLocked:!0}:{thumbnail:"",pageCount:0,isLocked:!1}}},R=async(e,t)=>{try{const a=await e.arrayBuffer(),o=await c({data:a,password:t,cMapUrl:`${window.location.origin}/PaperKnife/cmaps/`,cMapPacked:!0}).promise;return{thumbnail:await w(o,1),pageCount:o.numPages,isLocked:!1,success:!0,pdfDoc:o}}catch{return{thumbnail:"",pageCount:0,isLocked:!0,success:!1}}};function L(){return u.jsxs("div",{className:"mt-8 flex items-center justify-center gap-2 text-xs font-bold uppercase tracking-widest text-gray-400 dark:text-zinc-600",children:[u.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"100% Client-Side Processing"]})}export{L as P,v as d,E as g,S as l,w as r,D as s,R as u};
