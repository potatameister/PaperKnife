import{C as $,j as e}from"./index-ef-SArAk.js";import{r as o,v as k,l as R,a0 as M,Z as I,a8 as O,a1 as A,a9 as B,D as U,E as w,Y as Z,_ as V}from"./vendor-ui-oQLMzIE7.js";import{T as W}from"./tesseract-core-DdUE-rp4.js";import{N as X,P as Y,u as _,g as q,l as G,d as H}from"./NativeToolLayout-DAi18zbJ.js";import"./pdfjs-viewer-BENO9Ct1.js";function se(){const j=o.useRef(null),[t,u]=o.useState(null),[i,b]=o.useState(""),[d,n]=o.useState(!1),[y,f]=o.useState(0),[x,N]=o.useState("text"),[g,z]=o.useState(""),[D,v]=o.useState(!1),h=$.isNativePlatform(),T=async()=>{if(!t||!g)return;n(!0);const s=await _(t.file,g);s.success?u({...t,isLocked:!1,pageCount:s.pageCount,pdfDoc:s.pdfDoc,password:g}):w.error("Incorrect password"),n(!1)},S=async s=>{if(s.type==="application/pdf"){n(!0);try{const a=await q(s);if(a.isLocked)u({file:s,pageCount:0,isLocked:!0});else{const p=await G(s);u({file:s,pageCount:a.pageCount,isLocked:!1,pdfDoc:p})}b("")}catch(a){console.error(a)}finally{n(!1)}}},F=async()=>{if(!(!t||!t.pdfDoc)){n(!0),f(0),b("");try{let s="";if(x==="text")for(let a=1;a<=t.pageCount;a++){const r=await(await t.pdfDoc.getPage(a)).getTextContent();s+=`--- Page ${a} ---
${r.items.map(c=>c.str).join(" ")}

`,f(Math.round(a/t.pageCount*100))}else{const a=await W.createWorker("eng",1,{logger:r=>{if(r.status==="recognizing text"){const c=(p-1)/t.pageCount*100;f(Math.round(c+r.progress*(100/t.pageCount)))}}});let p=1;for(let r=1;r<=t.pageCount;r++){p=r;const c=await t.pdfDoc.getPage(r),m=c.getViewport({scale:2}),l=document.createElement("canvas"),P=l.getContext("2d");if(!P)continue;l.height=m.height,l.width=m.width,await c.render({canvasContext:P,viewport:m}).promise;const{data:{text:L}}=await a.recognize(l);s+=`--- Page ${r} (OCR) ---
${L}

`,l.width=0,l.height=0}await a.terminate()}b(s),w.success("Complete!")}catch(s){w.error(s.message)}finally{n(!1)}}},E=async()=>{await H(i,`${t?.file.name.replace(".pdf","")}-extracted.txt`,"text/plain")},C=()=>e.jsx("button",{onClick:F,disabled:d,className:`w-full bg-rose-500 hover:bg-rose-600 text-white font-black uppercase tracking-widest transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3 shadow-xl shadow-rose-500/20 ${h?"py-4 rounded-2xl text-sm":"p-6 rounded-3xl text-xl"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"animate-spin"})," ",y,"%"]}):e.jsxs(e.Fragment,{children:["Extract Text ",e.jsx(V,{size:18})]})});return e.jsxs(X,{title:"PDF to Text",description:"Extract text using fast scan or deep local OCR.",icon:k,actions:t&&!t.isLocked&&!i&&e.jsx(C,{}),children:[e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:j,onChange:s=>s.target.files?.[0]&&S(s.target.files[0])}),t?t.isLocked?e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-white/5 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(R,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"Protected File"}),e.jsx("input",{type:"password",value:g,onChange:s=>z(s.target.value),placeholder:"Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-transparent focus:border-rose-500 outline-none font-bold text-center mb-4"}),e.jsx("button",{onClick:T,disabled:!g||d,className:"w-full bg-rose-500 text-white p-4 rounded-2xl font-black uppercase text-xs",children:"Unlock"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-3xl border border-gray-100 dark:border-white/5 flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-20 bg-gray-50 dark:bg-black rounded-xl border border-gray-100 dark:border-zinc-800 flex items-center justify-center text-rose-500",children:e.jsx(k,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-sm truncate dark:text-white",children:t.file.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 uppercase font-black",children:[t.pageCount," Pages â€¢ ",(t.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsx("button",{onClick:()=>u(null),className:"p-2 text-gray-400 hover:text-rose-500",children:e.jsx(M,{size:20})})]}),e.jsx("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-white/5 space-y-8",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsx("textarea",{readOnly:!0,value:i,className:"w-full h-80 bg-gray-50 dark:bg-black border border-gray-100 dark:border-white/5 rounded-2xl p-4 font-mono text-xs resize-none outline-none focus:border-rose-500"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(i),v(!0),setTimeout(()=>v(!1),2e3)},className:"flex-1 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white border border-gray-100 dark:border-white/5 p-4 rounded-2xl font-black flex items-center justify-center gap-2",children:[D?e.jsx(A,{size:18,className:"text-green-500"}):e.jsx(B,{size:18})," Copy"]}),e.jsxs("button",{onClick:E,className:"flex-[2] bg-gray-900 dark:bg-white text-white dark:text-black p-4 rounded-2xl font-black flex items-center justify-center gap-2 shadow-xl",children:[e.jsx(U,{size:18})," ",h?"Save .txt":"Download"]})]}),e.jsx("button",{onClick:()=>{b(""),f(0)},className:"w-full py-2 text-gray-400 uppercase font-black text-[10px]",children:"Extract Again"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>N("text"),className:`p-4 rounded-2xl border-2 transition-all flex flex-col items-center ${x==="text"?"border-rose-500 bg-rose-50/50 dark:bg-rose-900/10":"border-gray-100 dark:border-white/5"}`,children:[e.jsx(I,{size:20,className:x==="text"?"text-rose-500":"text-gray-400"}),e.jsx("span",{className:"font-black uppercase text-[10px] mt-1",children:"Fast Scan"})]}),e.jsxs("button",{onClick:()=>N("ocr"),className:`p-4 rounded-2xl border-2 transition-all flex flex-col items-center ${x==="ocr"?"border-rose-500 bg-rose-50/50 dark:bg-rose-900/10":"border-gray-100 dark:border-white/5"}`,children:[e.jsx(O,{size:20,className:x==="ocr"?"text-rose-500":"text-gray-400"}),e.jsx("span",{className:"font-black uppercase text-[10px] mt-1",children:"Deep OCR"})]})]}),d&&!h&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-gray-100 dark:bg-zinc-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-rose-500 h-full transition-all",style:{width:`${y}%`}})}),e.jsx("p",{className:"text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Scanning Document..."})]}),!h&&e.jsx(C,{})]})})]}):e.jsxs("div",{onClick:()=>!d&&j.current?.click(),className:"border-4 border-dashed border-gray-100 dark:border-zinc-900 rounded-[2.5rem] p-12 text-center hover:bg-rose-50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group",children:[e.jsx("div",{className:"w-20 h-20 bg-rose-50 dark:bg-rose-900/20 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(k,{size:32})}),e.jsx("h3",{className:"text-xl font-bold dark:text-white mb-2",children:"Select PDF"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to browse files"})]}),e.jsx(Y,{})]})}export{se as default};
