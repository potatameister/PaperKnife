import{j as e,R as h,d as $,D as E,t as v,e as A}from"./index-vG0bn-q0.js";import{r as n}from"./utilities-8Xav_QdM.js";import{P as B,d as I}from"./pdf-core-B42Ge-vd.js";import{u as O,g as M,l as H,r as _}from"./pdfHelpers-quNdLaSm.js";import{T as q,L as N,P as G}from"./PrivacyBadge-2XgPbjSP.js";import{S as J}from"./SuccessState-BxUCUFo3.js";import{R as K}from"./refresh-ccw-BHCzt06u.js";import"./pdf-viewer-DFtpL4X_.js";const Q=({pdfDoc:d,pageNum:s,rotation:c})=>{const[l,x]=n.useState(null),a=n.useRef(null);return n.useEffect(()=>{if(!d||l)return;const o=new IntersectionObserver(p=>{p[0].isIntersecting&&(_(d,s,1).then(x),o.disconnect())},{rootMargin:"200px"});return a.current&&o.observe(a.current),()=>o.disconnect()},[d,s,l]),l?e.jsx("img",{src:l,className:"w-full h-full object-contain transition-transform duration-300 bg-white",style:{transform:`rotate(${c}deg)`},alt:`Page ${s}`}):e.jsx("div",{ref:a,className:"w-full h-full bg-gray-100 dark:bg-zinc-800 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-transparent rounded-full animate-spin"})})};function re(){const d=n.useRef(null),[s,c]=n.useState(null),[l,x]=n.useState({}),[a,o]=n.useState(!1),[p,m]=n.useState(null),[f,g]=n.useState("paperknife-rotated"),[u,P]=n.useState(""),C=async()=>{if(!s||!u)return;o(!0);const t=await O(s.file,u);t.success?(c({...s,isLocked:!1,pageCount:t.pageCount,pdfDoc:t.pdfDoc,password:u}),g(`${s.file.name.replace(".pdf","")}-rotated`)):v.error("Incorrect password"),o(!1)},z=async t=>{if(t.type==="application/pdf"){o(!0);try{const r=await M(t);if(r.isLocked)c({file:t,pageCount:0,isLocked:!0});else{const i=await H(t);c({file:t,pageCount:r.pageCount,isLocked:!1,pdfDoc:i}),g(`${t.name.replace(".pdf","")}-rotated`),x({})}}catch(r){console.error(r)}finally{o(!1),m(null)}}},R=t=>{x(r=>({...r,[t]:((r[t]||0)+90)%360})),m(null)},D=()=>{const t={...l};for(let r=1;r<=((s==null?void 0:s.pageCount)||0);r++)t[r]=((t[r]||0)+90)%360;x(t),m(null)},F=()=>{x({}),m(null)},S=async()=>{if(s){o(!0),await new Promise(t=>setTimeout(t,100));try{const t=await s.file.arrayBuffer(),r=await B.load(t,{password:s.password||void 0,ignoreEncryption:!0});r.getPages().forEach((y,L)=>{const U=L+1,w=l[U]||0;if(w!==0){const T=y.getRotation().angle;y.setRotation(I((T+w)%360))}});const b=await r.save(),j=new Blob([b],{type:"application/pdf"}),k=URL.createObjectURL(j);m(k),A({name:`${f}.pdf`,tool:"Rotate",size:j.size,resultUrl:k})}catch(t){v.error(`Error saving PDF: ${t.message}`)}finally{o(!1)}}};return e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-6 md:py-10",children:[e.jsx(q,{title:"Rotate",highlight:"PDF",description:"Fix page orientation permanently. Processed locally."}),e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:d,onChange:t=>{var r;return((r=t.target.files)==null?void 0:r[0])&&z(t.target.files[0])}}),s?s.isLocked?e.jsx("div",{className:"max-w-md mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx($,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"File is Protected"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 mb-8",children:"Unlock this file to rotate pages."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"password",value:u,onChange:t=>P(t.target.value),placeholder:"Enter Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold text-center transition-all",autoFocus:!0}),e.jsx("button",{onClick:C,disabled:!u||a,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all active:scale-95 disabled:opacity-50",children:a?"Unlocking...":"Unlock PDF"}),e.jsx("button",{onClick:()=>c(null),className:"w-full py-2 text-xs font-bold text-gray-400 hover:text-rose-500",children:"Choose different file"})]})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-[2rem] border border-gray-100 dark:border-zinc-800 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h4",{className:"font-black uppercase tracking-widest text-xs text-gray-400",children:"Tap pages to rotate"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-1 text-[10px] font-black uppercase text-rose-500 hover:underline",children:[e.jsx(h,{size:12})," Rotate All"]}),e.jsxs("button",{onClick:F,className:"flex items-center gap-1 text-[10px] font-black uppercase text-gray-400 hover:underline",children:[e.jsx(K,{size:12})," Reset"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-h-[60vh] overflow-y-auto p-2 scrollbar-hide",children:Array.from({length:s.pageCount}).map((t,r)=>{const i=r+1,b=l[i]||0;return e.jsxs("div",{onClick:()=>R(i),className:"relative group cursor-pointer aspect-[3/4] rounded-xl overflow-hidden border-2 border-transparent hover:border-rose-500 transition-all bg-gray-50 dark:bg-black",children:[e.jsx("div",{className:"w-full h-full p-2",children:e.jsx(Q,{pdfDoc:s.pdfDoc,pageNum:i,rotation:b})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 group-hover:bg-black/10 transition-colors",children:e.jsx("div",{className:"bg-white text-rose-500 p-2 rounded-full opacity-0 group-hover:opacity-100 shadow-lg transform scale-75 group-hover:scale-100 transition-all",children:e.jsx(h,{size:20})})}),e.jsxs("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/50 backdrop-blur-md rounded text-[10px] font-bold text-white uppercase tracking-tighter",children:["P. ",i]})]},i)})})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-zinc-800 shadow-sm sticky top-24",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold text-lg mb-1 dark:text-white truncate",children:s.file.name}),e.jsxs("p",{className:"text-xs text-gray-400 uppercase font-black tracking-widest",children:[s.pageCount," Pages â€¢ ",(s.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3",children:"Output Filename"}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus-within:border-rose-500 transition-colors",children:[e.jsx("input",{type:"text",value:f,onChange:t=>g(t.target.value),className:"bg-transparent outline-none flex-1 text-sm font-bold dark:text-white"}),e.jsx("span",{className:"text-gray-400 text-xs font-bold",children:".pdf"})]})]}),p?e.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:e.jsx(J,{message:"Success! PDF rotated.",downloadUrl:p,fileName:`${f}.pdf`,onStartOver:()=>m(null)})}):e.jsxs("button",{onClick:S,disabled:a,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-6 rounded-3xl shadow-xl shadow-rose-200 dark:shadow-none font-black text-xl tracking-tight transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3",children:[a?e.jsx(N,{className:"animate-spin"}):e.jsx(E,{}),"Save Rotated PDF"]}),e.jsx("button",{onClick:()=>c(null),className:"w-full py-2 text-[10px] font-black uppercase text-gray-300 hover:text-rose-500 transition-colors tracking-[0.2em]",children:"Close File"})]})]})})]}):e.jsx("div",{onClick:()=>{var t;return!a&&((t=d.current)==null?void 0:t.click())},className:`border-4 border-dashed border-gray-200 dark:border-zinc-800 rounded-[2rem] md:rounded-[2.5rem] bg-white/50 dark:bg-zinc-900/50 p-10 md:p-20 text-center hover:border-rose-300 dark:hover:border-rose-900 hover:bg-rose-50/50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group ${a?"opacity-50 cursor-wait":""}`,children:a?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(N,{size:48,className:"text-rose-500 animate-spin mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Analyzing PDF..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 md:w-24 md:h-24 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-4 md:mb-6 group-hover:scale-110 transition-transform",children:e.jsx(h,{size:32})}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold mb-1 md:mb-2 group-hover:text-rose-600 dark:group-hover:text-rose-400 transition-colors",children:"Select PDF"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-400 dark:text-zinc-500",children:"Tap to start rotating"})]})}),e.jsx(G,{})]})})}export{re as default};
