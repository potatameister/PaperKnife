import{j as e,a as b}from"./index-DZFvtcbn.js";import{r as s,Y as h,W as g,af as j,z as m}from"./vendor-ui-BKhDm7Mt.js";import{P as y}from"./pdf-lib-core-8ofwibqN.js";import{T as N,P as v}from"./PrivacyBadge-CPngxf1q.js";import{S as w}from"./SuccessState-DC-YrO0j.js";function z(){const o=s.useRef(null),[a,i]=s.useState(!1),[l,n]=s.useState(null),[p,f]=s.useState(""),u=async r=>{if(r.type==="application/pdf"){i(!0),f(r.name);try{const t=await r.arrayBuffer(),x=await(await y.load(t,{ignoreEncryption:!0,throwOnInvalidObject:!1})).save(),c=new Blob([x],{type:"application/pdf"}),d=URL.createObjectURL(c);n(d),b({name:`repaired-${r.name}`,tool:"Repair",size:c.size,resultUrl:d}),m.success("PDF rebuilt successfully!")}catch(t){m.error(`Could not repair PDF: ${t.message}`)}finally{i(!1)}}};return e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-4xl mx-auto px-6 py-6 md:py-10",children:[e.jsx(N,{title:"Repair",highlight:"PDF",description:"Attempt to fix corrupted or unreadable PDF files by rebuilding their internal structure."}),e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:o,onChange:r=>r.target.files?.[0]&&u(r.target.files[0])}),l?e.jsx(w,{message:"Reconstruction Complete!",downloadUrl:l,fileName:`repaired-${p}`,onStartOver:()=>n(null)}):e.jsx("div",{onClick:()=>!a&&o.current?.click(),className:`border-4 border-dashed border-gray-200 dark:border-zinc-800 rounded-[2.5rem] bg-white/50 dark:bg-zinc-900/50 p-20 text-center hover:border-rose-300 dark:hover:border-rose-900 transition-all cursor-pointer group ${a?"opacity-50":""}`,children:a?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(h,{size:48,className:"text-rose-500 animate-spin mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Rebuilding PDF..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-24 h-24 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(g,{size:40})}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Select Corrupted PDF"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to upload and attempt repair"})]})}),e.jsxs("div",{className:"mt-8 p-6 bg-amber-50 dark:bg-amber-900/10 rounded-2xl border border-amber-100 dark:border-amber-900/20 flex items-start gap-4",children:[e.jsx(j,{className:"text-amber-500 shrink-0",size:20}),e.jsxs("div",{className:"text-xs text-amber-700 dark:text-amber-400 leading-relaxed",children:[e.jsx("p",{className:"font-bold mb-1 uppercase",children:"How it works:"}),"PaperKnife uses a safe-load algorithm to bypass minor corruption in the PDF stream and generates a fresh Cross-Reference Table. This can fix files that refuse to open in some viewers. Note: Highly corrupted files with missing data may still fail."]})]}),e.jsx(v,{})]})})}export{z as default};
