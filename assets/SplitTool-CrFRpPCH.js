import{c as M,j as e,a as Z,b as q,D as J,d as L}from"./index-CLWChjxT.js";import{r as o,J as _}from"./utilities-FAq1q_T3.js";import{P as C}from"./pdf-core-CNWTKtlN.js";import{L as $,a as V,u as W,r as G,g as H,l as K}from"./pdfHelpers-DY_8wyQ3.js";import{P as Q,E as X}from"./pen-DAjMop9g.js";import"./pdf-viewer-DFtpL4X_.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=M("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=M("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),ee=({pdfDoc:b,pageNum:a})=>{const[c,v]=o.useState(null),f=o.useRef(null);return o.useEffect(()=>{if(!b||c)return;const d=new IntersectionObserver(h=>{h[0].isIntersecting&&(G(b,a).then(v),d.disconnect())},{rootMargin:"200px"});return f.current&&d.observe(f.current),()=>d.disconnect()},[b,a,c]),c?e.jsx("img",{src:c,className:"w-full h-full object-cover animate-in fade-in duration-300",alt:`Page ${a}`}):e.jsx("div",{ref:f,className:"w-full h-full bg-gray-100 dark:bg-zinc-800 flex items-center justify-center text-xs font-bold text-gray-400",children:e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-transparent rounded-full animate-spin"})})};function oe(){const b=o.useRef(null),[a,c]=o.useState(null),[v,f]=o.useState(!1),[d,h]=o.useState(!1),[N,x]=o.useState(null),[g,k]=o.useState(new Set),[w,I]=o.useState("paperknife-split"),[D,z]=o.useState(""),[y,F]=o.useState("single"),[j,R]=o.useState(""),E=async()=>{if(!a||!j)return;h(!0);const t=await W(a.file,j);if(t.success){c({...a,isLocked:!1,pageCount:t.pageCount,pdfDoc:t.pdfDoc,password:j});const s=new Set;for(let r=1;r<=t.pageCount;r++)s.add(r);k(s),z(`1-${t.pageCount}`)}else alert("Incorrect password");h(!1)},U=async t=>{if(t.type==="application/pdf"){h(!0);try{const s=await H(t);if(s.isLocked)c({file:t,pageCount:0,isLocked:!0});else{const r=await K(t);c({file:t,pageCount:s.pageCount,isLocked:!1,pdfDoc:r});const l=new Set;for(let n=1;n<=s.pageCount;n++)l.add(n);k(l),z(`1-${s.pageCount}`)}}catch(s){console.error(s)}finally{h(!1),x(null)}}},A=t=>{var s;(s=t.target.files)!=null&&s[0]&&U(t.target.files[0])},B=t=>{const s=new Set(g);s.has(t)?s.delete(t):s.add(t),k(s),x(null)},T=t=>{if(!a)return;const s=new Set;t.split(",").map(l=>l.trim()).forEach(l=>{if(l.includes("-")){const[n,u]=l.split("-").map(Number);if(!isNaN(n)&&!isNaN(u))for(let i=Math.max(1,n);i<=Math.min(u,a.pageCount);i++)s.add(i)}else{const n=Number(l);!isNaN(n)&&n>=1&&n<=a.pageCount&&s.add(n)}}),k(s),x(null)},O=async()=>{if(!(!a||g.size===0)){f(!0),await new Promise(t=>setTimeout(t,100));try{const t=await a.file.arrayBuffer(),s=await C.load(t,{password:a.password});if(y==="single"){const r=await C.create(),l=Array.from(g).sort((m,P)=>m-P).map(m=>m-1);(await r.copyPages(s,l)).forEach(m=>r.addPage(m));const u=await r.save(),i=new Blob([u],{type:"application/pdf"}),p=URL.createObjectURL(i);x(p),L({name:`${w||"split"}.pdf`,tool:"Split",size:i.size,resultUrl:p})}else{const r=new _,l=Array.from(g).sort((i,p)=>i-p);for(const i of l){const p=await C.create(),[m]=await p.copyPages(s,[i-1]);p.addPage(m);const P=await p.save();r.file(`${w||"page"}-${i}.pdf`,P)}const n=await r.generateAsync({type:"blob"}),u=URL.createObjectURL(n);x(u),L({name:`${w||"split"}.zip`,tool:"Split",size:n.size,resultUrl:u})}}catch(t){alert(t.message||"Error splitting PDF.")}finally{f(!1)}}};return e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-6 md:py-10",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsxs("h2",{className:"text-3xl md:text-5xl font-black mb-3 md:mb-4 dark:text-white",children:["Visual ",e.jsx("span",{className:"text-rose-500",children:"Splitter."})]}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 dark:text-zinc-400",children:["Select pages visually or by range to extract them. ",e.jsx("br",{className:"hidden md:block"}),"Everything stays on your device."]})]}),e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:b,onChange:A}),a?a.isLocked?e.jsx("div",{className:"max-w-md mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(V,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"File is Protected"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 mb-8",children:"This PDF requires a password to open."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"password",value:j,onChange:t=>R(t.target.value),placeholder:"Enter Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold text-center transition-all",autoFocus:!0}),e.jsx("button",{onClick:E,disabled:!j||d,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all active:scale-95 disabled:opacity-50",children:d?"Unlocking...":"Unlock PDF"}),e.jsx("button",{onClick:()=>c(null),className:"w-full py-2 text-xs font-bold text-gray-400 hover:text-rose-500",children:"Choose different file"})]})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-[2rem] border border-gray-100 dark:border-zinc-800 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h4",{className:"font-black uppercase tracking-widest text-xs text-gray-400",children:"Click to select pages"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const t=new Set;for(let s=1;s<=a.pageCount;s++)t.add(s);k(t)},className:"text-[10px] font-black uppercase text-rose-500 hover:underline",children:"Select All"}),e.jsx("button",{onClick:()=>k(new Set),className:"text-[10px] font-black uppercase text-gray-400 hover:underline",children:"Deselect All"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-h-[60vh] overflow-y-auto p-2 scrollbar-hide",children:Array.from({length:a.pageCount}).map((t,s)=>{const r=s+1,l=g.has(r);return e.jsxs("div",{onClick:()=>B(r),className:`relative group cursor-pointer aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all ${l?"border-rose-500 shadow-lg scale-[1.02]":"border-transparent hover:border-gray-200 dark:hover:border-zinc-700"}`,children:[e.jsx(ee,{pdfDoc:a.pdfDoc,pageNum:r}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-opacity ${l?"bg-rose-500/10 opacity-100":"bg-black/20 opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shadow-lg transition-transform ${l?"bg-rose-500 text-white scale-100":"bg-white text-gray-400 scale-75"}`,children:l?e.jsx(Y,{size:20,strokeWidth:3}):e.jsx(Z,{size:20})})}),e.jsxs("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/50 backdrop-blur-md rounded text-[10px] font-bold text-white uppercase tracking-tighter",children:["P. ",r]})]},r)})})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-zinc-800 shadow-sm sticky top-24",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold text-lg mb-1 dark:text-white truncate",children:a.file.name}),e.jsxs("p",{className:"text-xs text-gray-400 uppercase font-black tracking-widest",children:[a.pageCount," Pages â€¢ ",(a.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(S,{size:12})," Split Mode"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 bg-gray-50 dark:bg-black p-1 rounded-2xl border border-gray-100 dark:border-zinc-800",children:[e.jsx("button",{onClick:()=>{F("single"),x(null)},className:`py-2 px-3 rounded-xl text-[10px] font-black uppercase transition-all ${y==="single"?"bg-white dark:bg-zinc-800 text-rose-500 shadow-sm":"text-gray-400"}`,children:"Single File"}),e.jsx("button",{onClick:()=>{F("individual"),x(null)},className:`py-2 px-3 rounded-xl text-[10px] font-black uppercase transition-all ${y==="individual"?"bg-white dark:bg-zinc-800 text-rose-500 shadow-sm":"text-gray-400"}`,children:"Individual (ZIP)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(Q,{size:12})," Custom Filename"]}),e.jsx("input",{type:"text",value:w,onChange:t=>I(t.target.value),className:"w-full bg-gray-50 dark:bg-black rounded-xl px-4 py-3 border border-gray-100 dark:border-zinc-800 text-sm font-bold outline-none focus:border-rose-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(S,{size:12})," Range Selector"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:D,onChange:t=>z(t.target.value),placeholder:"e.g. 1, 3-5",className:"flex-1 bg-gray-50 dark:bg-black rounded-xl px-4 py-3 border border-gray-100 dark:border-zinc-800 text-sm font-bold outline-none focus:border-rose-500"}),e.jsx("button",{onClick:()=>T(D),className:"px-4 bg-gray-100 dark:bg-zinc-800 rounded-xl font-bold text-xs hover:bg-gray-200 dark:hover:bg-zinc-700 transition-colors",children:"Apply"})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-100 dark:border-zinc-800",children:[e.jsxs("div",{className:"flex justify-between items-end mb-4 px-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Selection"}),e.jsxs("span",{className:"text-xl font-black text-rose-500",children:[g.size," ",e.jsx("span",{className:"text-xs text-gray-400",children:"Pages"})]})]}),N?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 p-3 rounded-xl flex items-center justify-center gap-2 font-bold text-xs border border-green-100 dark:border-green-900/30",children:[e.jsx(q,{size:16})," Ready for Download"]}),y==="single"&&e.jsxs("button",{onClick:()=>window.open(N,"_blank"),className:"w-full bg-white dark:bg-zinc-800 text-gray-900 dark:text-white p-4 rounded-2xl font-black flex items-center justify-center gap-3 border border-gray-200 dark:border-zinc-700 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-all active:scale-95",children:[e.jsx(X,{size:20})," Preview PDF"]}),e.jsxs("a",{href:N,download:`${w||"split"}.${y==="single"?"pdf":"zip"}`,className:"w-full bg-gray-900 dark:bg-white text-white dark:text-black p-4 rounded-2xl font-black flex items-center justify-center gap-3 hover:scale-[1.02] active:scale-95 transition-all",children:[e.jsx(J,{size:20})," Download ",y==="single"?"PDF":"ZIP"]}),e.jsx("button",{onClick:()=>x(null),className:"w-full py-2 text-xs font-black uppercase text-gray-400 hover:text-rose-500",children:"Edit Selection"})]}):e.jsx("button",{onClick:O,disabled:v||g.size===0,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-4 rounded-2xl shadow-xl shadow-rose-200 dark:shadow-none font-black tracking-tight transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3",children:v?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"animate-spin"})," Splitting..."]}):"Extract Selection"})]}),e.jsx("button",{onClick:()=>c(null),className:"w-full py-2 text-[10px] font-black uppercase text-gray-300 hover:text-rose-500 transition-colors tracking-[0.2em]",children:"Close File"})]})]})})]}):e.jsx("div",{onClick:()=>{var t;return!d&&((t=b.current)==null?void 0:t.click())},className:`border-4 border-dashed border-gray-200 dark:border-zinc-800 rounded-[2rem] md:rounded-[2.5rem] bg-white/50 dark:bg-zinc-900/50 p-10 md:p-20 text-center hover:border-rose-300 dark:hover:border-rose-900 hover:bg-rose-50/50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group ${d?"opacity-50 cursor-wait":""}`,children:d?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx($,{size:48,className:"text-rose-500 animate-spin mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Analyzing PDF..."}),e.jsxs("p",{className:"text-xs text-gray-400 max-w-xs mx-auto leading-relaxed",children:["Processing is 100% local on your device. ",e.jsx("br",{}),"Large files may take a moment depending on your hardware."]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 md:w-24 md:h-24 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-4 md:mb-6 group-hover:scale-110 transition-transform",children:e.jsx(S,{size:32})}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold mb-1 md:mb-2 group-hover:text-rose-600 dark:group-hover:text-rose-400 transition-colors",children:"Select PDF"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-400 dark:text-zinc-500",children:"Tap to start splitting"})]})})]})})}export{oe as default};
