import{C as Y,j as e,a as q}from"./index-ClNaXagY.js";import{r as a,s as F,l as G,$ as J,E as L,X as K,Y as Q}from"./vendor-ui-ChuGOVJJ.js";import{P as V,S as Z,r as _}from"./pdf-lib-core-HBqI1UMO.js";import{P as ee,u as te,g as se}from"./PrivacyBadge-ieXyoJug.js";import{S as re}from"./SuccessState-DQG7Fuki.js";import{N as ae}from"./NativeToolLayout-WU51Jcs9.js";import"./pdfjs-viewer-BENO9Ct1.js";function xe(){const f=a.useRef(null),[s,x]=a.useState(null),[l,o]=a.useState(!1),[m,p]=a.useState(null),[n,D]=a.useState(""),[h,B]=a.useState("Page {n} of {total}"),[i,U]=a.useState("bottom-center"),[y]=a.useState(1),[b]=a.useState(10),[A]=a.useState("#6B7280"),w=Y.isNativePlatform(),R=async()=>{if(!s||!n)return;o(!0);const t=await te(s.file,n);t.success?x({...s,isLocked:!1,pageCount:t.pageCount,password:n}):L.error("Incorrect password"),o(!1)},T=async t=>{if(t.type==="application/pdf"){o(!0);try{const r=await se(t);x({file:t,pageCount:r.pageCount,isLocked:r.isLocked})}catch(r){console.error(r)}finally{o(!1),p(null)}}},E=t=>{const r=parseInt(t.slice(1,3),16)/255,c=parseInt(t.slice(3,5),16)/255,d=parseInt(t.slice(5,7),16)/255;return _(r,c,d)},I=async()=>{if(s){o(!0),await new Promise(t=>setTimeout(t,100));try{const t=await s.file.arrayBuffer(),r=await V.load(t,{password:s.password||void 0,ignoreEncryption:!0}),c=await r.embedFont(Z.Helvetica),d=r.getPages(),$=E(A);d.forEach((v,H)=>{const{width:P,height:M}=v.getSize(),X=H+y,W=d.length+(y-1),S=h.replace("{n}",X.toString()).replace("{total}",W.toString()),z=c.widthOfTextAtSize(S,b),u=30;let g=P/2-z/2,C=u;i.includes("left")&&(g=u),i.includes("right")&&(g=P-z-u),i.includes("top")&&(C=M-u-b),v.drawText(S,{x:g,y:C,size:b,font:c,color:$})});const O=await r.save(),k=new Blob([O],{type:"application/pdf"}),N=URL.createObjectURL(k);p(N),q({name:`numbered-${s.file.name}`,tool:"Page Numbers",size:k.size,resultUrl:N})}catch(t){L.error(`Error: ${t.message}`)}finally{o(!1)}}},j=()=>e.jsx("button",{onClick:I,disabled:l,className:`w-full bg-rose-500 hover:bg-rose-600 text-white font-black uppercase tracking-widest transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3 shadow-xl shadow-rose-500/20 ${w?"py-4 rounded-2xl text-sm":"p-6 rounded-3xl text-xl"}`,children:l?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"animate-spin"})," Numbering..."]}):e.jsxs(e.Fragment,{children:["Add Numbers ",e.jsx(Q,{size:18})]})});return e.jsxs(ae,{title:"Page Numbers",description:"Add custom numbering to your PDF automatically.",actions:s&&!s.isLocked&&!m&&e.jsx(j,{}),children:[e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:f,onChange:t=>t.target.files?.[0]&&T(t.target.files[0])}),s?s.isLocked?e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-white/5 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(G,{size:32})}),e.jsx("input",{type:"password",value:n,onChange:t=>D(t.target.value),placeholder:"Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-transparent focus:border-rose-500 outline-none font-bold text-center mb-4"}),e.jsx("button",{onClick:R,disabled:!n||l,className:"w-full bg-rose-500 text-white p-4 rounded-2xl font-black uppercase text-xs",children:"Unlock"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-3xl border border-gray-100 dark:border-white/5 flex items-center gap-6",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-50 dark:bg-rose-900/20 text-rose-500 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(F,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-sm truncate dark:text-white",children:s.file.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 uppercase font-black",children:[s.pageCount," Pages â€¢ ",(s.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsx("button",{onClick:()=>x(null),className:"p-2 text-gray-400 hover:text-rose-500 transition-colors",children:e.jsx(J,{size:20})})]}),e.jsx("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-white/5 space-y-6",children:m?e.jsx(re,{message:"Numbers Added!",downloadUrl:m,fileName:`numbered-${s.file.name}`,onStartOver:()=>p(null)}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase text-gray-400 mb-2",children:"Format"}),e.jsx("input",{type:"text",value:h,onChange:t=>B(t.target.value),className:"w-full bg-gray-50 dark:bg-black rounded-xl px-4 py-3 border border-transparent focus:border-rose-500 outline-none font-bold text-sm",placeholder:"Page {n} of {total}"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["top-left","top-center","top-right","bottom-left","bottom-center","bottom-right"].map(t=>e.jsx("button",{onClick:()=>U(t),className:`py-2 px-1 rounded-xl text-[8px] font-black uppercase transition-all border ${i===t?"bg-rose-500 text-white border-rose-500":"bg-gray-50 dark:bg-black text-gray-400 border-gray-100 dark:border-zinc-800"}`,children:t.replace("-"," ")},t))}),!w&&e.jsx(j,{})]})})]}):e.jsxs("div",{onClick:()=>!l&&f.current?.click(),className:"border-4 border-dashed border-gray-100 dark:border-zinc-900 rounded-[2.5rem] p-12 text-center hover:bg-rose-50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group",children:[e.jsx("div",{className:"w-20 h-20 bg-rose-50 dark:bg-rose-900/20 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(F,{size:32})}),e.jsx("h3",{className:"text-xl font-bold dark:text-white mb-2",children:"Select PDF"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to start numbering"})]}),e.jsx(ee,{})]})}export{xe as default};
