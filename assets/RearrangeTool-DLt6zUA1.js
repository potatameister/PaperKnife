import{c as U,j as e,G as E,D as v,b as O,d as $}from"./index-BIa2FiX5.js";import{r as c,u as A,b as N,D as M,c as T,S as q,f as B,s as G,K,P as _,d as H,e as J,C as Q}from"./utilities-BzjkILRQ.js";import{P}from"./pdf-core-CNWTKtlN.js";import{L as C,a as V,u as W,g as X,l as Y,r as Z}from"./pdfHelpers-70vGty3R.js";import{R as ee}from"./refresh-ccw-lmm6ipgV.js";import"./pdf-viewer-DFtpL4X_.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=U("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),te=({pdfDoc:d,pageNum:t})=>{const[o,m]=c.useState(null),l=c.useRef(null);return c.useEffect(()=>{if(!d||o)return;const n=new IntersectionObserver(i=>{i[0].isIntersecting&&(Z(d,t).then(m),n.disconnect())},{rootMargin:"200px"});return l.current&&n.observe(l.current),()=>n.disconnect()},[d,t,o]),o?e.jsx("img",{src:o,className:"w-full h-full object-contain bg-white",alt:`Page ${t}`}):e.jsx("div",{ref:l,className:"w-full h-full bg-gray-100 dark:bg-zinc-800 flex items-center justify-center",children:e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-transparent rounded-full animate-spin"})})};function se({id:d,pageNum:t,pdfDoc:o}){const{attributes:m,listeners:l,setNodeRef:n,transform:i,transition:b,isDragging:x}=J({id:d}),u={transform:Q.Transform.toString(i),transition:b,zIndex:x?50:0};return e.jsxs("div",{ref:n,style:u,...m,...l,className:`relative group cursor-grab active:cursor-grabbing aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all bg-gray-50 dark:bg-black ${x?"border-rose-500 shadow-xl scale-105 opacity-90":"border-transparent hover:border-gray-200 dark:hover:border-zinc-700"}`,children:[e.jsx("div",{className:"w-full h-full p-2",children:e.jsx(te,{pdfDoc:o,pageNum:t})}),e.jsx("div",{className:"absolute top-2 right-2 bg-black/50 backdrop-blur-md rounded-lg p-1 text-white opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(re,{size:14})}),e.jsxs("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/50 backdrop-blur-md rounded text-[10px] font-bold text-white uppercase tracking-tighter",children:["P. ",t]})]})}function de(){const d=c.useRef(null),[t,o]=c.useState(null),[m,l]=c.useState([]),[n,i]=c.useState(!1),[b,x]=c.useState(null),[u,h]=c.useState("paperknife-rearranged"),[p,D]=c.useState(""),z=A(N(_),N(K,{coordinateGetter:G})),S=async()=>{if(!t||!p)return;i(!0);const r=await W(t.file,p);r.success?(o({...t,isLocked:!1,pageCount:r.pageCount,pdfDoc:r.pdfDoc,password:p}),l(Array.from({length:r.pageCount},(s,a)=>(a+1).toString())),h(`${t.file.name.replace(".pdf","")}-rearranged`)):alert("Incorrect password"),i(!1)},F=async r=>{if(r.type==="application/pdf"){i(!0);try{const s=await X(r);if(s.isLocked)o({file:r,pageCount:0,isLocked:!0});else{const a=await Y(r);o({file:r,pageCount:s.pageCount,isLocked:!1,pdfDoc:a}),l(Array.from({length:s.pageCount},(g,f)=>(f+1).toString())),h(`${r.name.replace(".pdf","")}-rearranged`)}}catch(s){console.error(s)}finally{i(!1),x(null)}}},R=r=>{const{active:s,over:a}=r;s.id!==(a==null?void 0:a.id)&&(l(g=>{const f=g.indexOf(s.id),y=g.indexOf(a==null?void 0:a.id);return H(g,f,y)}),x(null))},L=()=>{t&&(l(Array.from({length:t.pageCount},(r,s)=>(s+1).toString())),x(null))},I=async()=>{if(t){i(!0),await new Promise(r=>setTimeout(r,100));try{const r=await t.file.arrayBuffer(),s=await P.load(r,{password:t.password||void 0,ignoreEncryption:!0}),a=await P.create(),g=m.map(k=>parseInt(k)-1);(await a.copyPages(s,g)).forEach(k=>a.addPage(k));const y=await a.save(),j=new Blob([y],{type:"application/pdf"}),w=URL.createObjectURL(j);x(w),$({name:`${u}.pdf`,tool:"Rearrange",size:j.size,resultUrl:w})}catch(r){alert(`Error saving PDF: ${r.message}`)}finally{i(!1)}}};return e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-6 md:py-10",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsxs("h2",{className:"text-3xl md:text-5xl font-black mb-3 md:mb-4 dark:text-white",children:["Rearrange ",e.jsx("span",{className:"text-rose-500",children:"PDF."})]}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 dark:text-zinc-400",children:["Drag and drop to reorder pages. ",e.jsx("br",{className:"hidden md:block"}),"Processed locally."]})]}),e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:d,onChange:r=>{var s;return((s=r.target.files)==null?void 0:s[0])&&F(r.target.files[0])}}),t?t.isLocked?e.jsx("div",{className:"max-w-md mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(V,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"File is Protected"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 mb-8",children:"Unlock this file to rearrange pages."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"password",value:p,onChange:r=>D(r.target.value),placeholder:"Enter Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold text-center transition-all",autoFocus:!0}),e.jsx("button",{onClick:S,disabled:!p||n,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all active:scale-95 disabled:opacity-50",children:n?"Unlocking...":"Unlock PDF"}),e.jsx("button",{onClick:()=>o(null),className:"w-full py-2 text-xs font-bold text-gray-400 hover:text-rose-500",children:"Choose different file"})]})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-[2rem] border border-gray-100 dark:border-zinc-800 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h4",{className:"font-black uppercase tracking-widest text-xs text-gray-400",children:"Drag pages to reorder"}),e.jsxs("button",{onClick:L,className:"flex items-center gap-1 text-[10px] font-black uppercase text-gray-400 hover:text-rose-500 transition-colors",children:[e.jsx(ee,{size:12})," Reset Order"]})]}),e.jsx(M,{sensors:z,collisionDetection:T,onDragEnd:R,children:e.jsx(q,{items:m,strategy:B,children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-h-[60vh] overflow-y-auto p-2 scrollbar-hide",children:m.map(r=>e.jsx(se,{id:r,pageNum:parseInt(r),pdfDoc:t.pdfDoc},r))})})})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-zinc-800 shadow-sm sticky top-24",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold text-lg mb-1 dark:text-white truncate",children:t.file.name}),e.jsxs("p",{className:"text-xs text-gray-400 uppercase font-black tracking-widest",children:[t.pageCount," Pages â€¢ ",(t.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3",children:"Output Filename"}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus-within:border-rose-500 transition-colors",children:[e.jsx("input",{type:"text",value:u,onChange:r=>h(r.target.value),className:"bg-transparent outline-none flex-1 text-sm font-bold dark:text-white"}),e.jsx("span",{className:"text-gray-400 text-xs font-bold",children:".pdf"})]})]}),b?e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 p-4 rounded-2xl flex items-center justify-center gap-2 font-bold text-sm border border-green-100 dark:border-green-900/30",children:[e.jsx(O,{size:20})," Success!"]}),e.jsxs("a",{href:b,download:`${u}.pdf`,className:"w-full bg-gray-900 dark:bg-white text-white dark:text-black p-6 rounded-3xl font-black text-xl flex items-center justify-center gap-3 hover:scale-[1.01] active:scale-95 transition-all shadow-xl",children:[e.jsx(v,{size:24})," Download PDF"]}),e.jsx("button",{onClick:()=>x(null),className:"w-full py-2 text-xs font-black uppercase text-gray-400 hover:text-rose-500 tracking-[0.2em]",children:"Arrange Again"})]}):e.jsxs("button",{onClick:I,disabled:n,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-6 rounded-3xl shadow-xl shadow-rose-200 dark:shadow-none font-black text-xl tracking-tight transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3",children:[n?e.jsx(C,{className:"animate-spin"}):e.jsx(v,{}),"Save PDF"]}),e.jsx("button",{onClick:()=>o(null),className:"w-full py-2 text-[10px] font-black uppercase text-gray-300 hover:text-rose-500 transition-colors tracking-[0.2em]",children:"Close File"})]})]})})]}):e.jsx("div",{onClick:()=>{var r;return!n&&((r=d.current)==null?void 0:r.click())},className:`border-4 border-dashed border-gray-200 dark:border-zinc-800 rounded-[2rem] md:rounded-[2.5rem] bg-white/50 dark:bg-zinc-900/50 p-10 md:p-20 text-center hover:border-rose-300 dark:hover:border-rose-900 hover:bg-rose-50/50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group ${n?"opacity-50 cursor-wait":""}`,children:n?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(C,{size:48,className:"text-rose-500 animate-spin mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Analyzing PDF..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 md:w-24 md:h-24 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-4 md:mb-6 group-hover:scale-110 transition-transform",children:e.jsx(E,{size:32})}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold mb-1 md:mb-2 group-hover:text-rose-600 dark:group-hover:text-rose-400 transition-colors",children:"Select PDF"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-400 dark:text-zinc-500",children:"Tap to start arranging"})]})})]})})}export{de as default};
