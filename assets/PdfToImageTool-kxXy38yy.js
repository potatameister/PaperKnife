import{u as A,C as E,j as e,a as M}from"./index-DVQ_-K-e.js";import{r,t as w,aa as C,p as O,X as J,a2 as Z,a3 as q}from"./vendor-ui-DVJtqS_b.js";import{J as V}from"./vendor-utils-BuRRKp-C.js";import{g as X,l as G,P as H,u as K}from"./PrivacyBadge-BptljzUF.js";import{S as Q}from"./SuccessState-R0HWCMze.js";import{N as W}from"./NativeToolLayout-Bywg2nrF.js";import"./tesseract-core-8J3qwSEB.js";import"./pdfjs-viewer-BENO9Ct1.js";function ie(){const k=r.useRef(null),{consumePipelineFile:P,setPipelineFile:z}=A(),[a,o]=r.useState(null),[p,n]=r.useState(!1),[D,x]=r.useState(0),[g,f]=r.useState(null),[u,F]=r.useState("jpg"),[i,b]=r.useState("paperknife-images"),[l,S]=r.useState(""),I=E.isNativePlatform();r.useEffect(()=>{const t=P();if(t){if(t.type&&t.type!=="application/pdf"){w.error("The file from the previous tool is not a PDF and cannot be used here.");return}const s=new File([t.buffer],t.name,{type:"application/pdf"});j(s)}},[]);const L=async()=>{if(!a||!l)return;n(!0);const t=await K(a.file,l);t.success?(o({...a,isLocked:!1,pageCount:t.pageCount,pdfDoc:t.pdfDoc,thumbnail:t.thumbnail,password:l}),b(`${a.file.name.replace(".pdf","")}-images`)):w.error("Incorrect password"),n(!1)},j=async t=>{if(t.type==="application/pdf"){n(!0);try{const s=await X(t);if(s.isLocked)o({file:t,pageCount:0,isLocked:!0});else{const c=await G(t);o({file:t,pageCount:s.pageCount,isLocked:!1,pdfDoc:c,thumbnail:s.thumbnail}),b(`${t.name.replace(".pdf","")}-images`)}}catch(s){console.error(s)}finally{n(!1),f(null)}}},$=async()=>{if(!(!a||!a.pdfDoc)){n(!0),x(0),await new Promise(t=>setTimeout(t,100));try{const t=new V,s=2;for(let d=1;d<=a.pageCount;d++){const v=await a.pdfDoc.getPage(d),h=v.getViewport({scale:s}),m=document.createElement("canvas"),N=m.getContext("2d");if(!N)continue;m.height=h.height,m.width=h.width,await v.render({canvasContext:N,viewport:h}).promise;const T=m.toDataURL(u==="png"?"image/png":"image/jpeg",.8).split(",")[1],B=d.toString().padStart(Math.max(2,a.pageCount.toString().length),"0");t.file(`${i}-${B}.${u}`,T,{base64:!0}),x(Math.round(d/a.pageCount*100))}const c=await t.generateAsync({type:"blob"}),y=URL.createObjectURL(c);f(y);const R=new Uint8Array(await c.arrayBuffer());z({buffer:R,name:`${i}.zip`,type:"application/zip"}),M({name:`${i}.zip`,tool:"PDF to Image",size:c.size,resultUrl:y})}catch(t){w.error(`Error: ${t.message}`)}finally{n(!1)}}},U=()=>e.jsx("button",{onClick:$,disabled:p,className:`w-full bg-rose-500 hover:bg-rose-600 text-white font-black uppercase tracking-widest transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3 shadow-xl shadow-rose-500/20 ${I?"py-4 rounded-2xl text-sm":"p-6 rounded-3xl text-xl"}`,children:p?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"animate-spin"})," ",D,"%"]}):e.jsxs(e.Fragment,{children:["Convert to Images ",e.jsx(q,{size:18})]})});return e.jsxs(W,{title:"PDF to Image",description:"Convert document pages into high-quality images.",actions:a&&!a.isLocked&&!g&&e.jsx(U,{}),children:[e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:k,onChange:t=>t.target.files?.[0]&&j(t.target.files[0])}),a?a.isLocked?e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-white/5 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(O,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"Protected File"}),e.jsx("input",{type:"password",value:l,onChange:t=>S(t.target.value),placeholder:"Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-transparent focus:border-rose-500 outline-none font-bold text-center mb-4"}),e.jsx("button",{onClick:L,disabled:!l||p,className:"w-full bg-rose-500 text-white p-4 rounded-2xl font-black uppercase text-xs",children:"Unlock"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-3xl border border-gray-100 dark:border-white/5 flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-20 bg-gray-50 dark:bg-black rounded-xl overflow-hidden shrink-0 border border-gray-100 dark:border-zinc-800 flex items-center justify-center text-rose-500",children:a.thumbnail?e.jsx("img",{src:a.thumbnail,className:"w-full h-full object-cover"}):e.jsx(C,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-sm truncate dark:text-white",children:a.file.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 uppercase font-black",children:[a.pageCount," Pages â€¢ ",(a.file.size/(1024*1024)).toFixed(1)," MB"]})]}),e.jsx("button",{onClick:()=>o(null),className:"p-2 text-gray-400 hover:text-rose-500 transition-colors",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2rem] border border-gray-100 dark:border-white/5 space-y-8 shadow-sm",children:[g?e.jsx(Q,{message:"Images Ready!",downloadUrl:g,fileName:`${i}.zip`,onStartOver:()=>{f(null),x(0),o(null)},showPreview:!1}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase text-gray-400 mb-4 tracking-widest px-1",children:"Image Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["jpg","png"].map(t=>e.jsx("button",{onClick:()=>F(t),className:`p-4 rounded-2xl border-2 transition-all flex flex-col items-center ${u===t?"border-rose-500 bg-rose-50/50 dark:bg-rose-900/10":"border-gray-100 dark:border-white/5"}`,children:e.jsx("span",{className:`font-black uppercase text-[10px] ${u===t?"text-rose-500":"text-gray-400"}`,children:t})},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase text-gray-400 mb-3 tracking-widest px-1",children:"Output ZIP Name"}),e.jsx("input",{type:"text",value:i,onChange:t=>b(t.target.value),className:"w-full bg-gray-50 dark:bg-black rounded-xl px-4 py-3 border border-transparent focus:border-rose-500 outline-none font-bold text-sm dark:text-white"})]})]}),e.jsx("button",{onClick:()=>o(null),className:"w-full py-2 text-[10px] font-black uppercase text-gray-300 hover:text-rose-500 transition-colors",children:"Close File"})]})]}):e.jsxs("div",{onClick:()=>!p&&k.current?.click(),className:"border-4 border-dashed border-gray-100 dark:border-zinc-900 rounded-[2.5rem] p-12 text-center hover:bg-rose-50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group",children:[e.jsx("div",{className:"w-20 h-20 bg-rose-50 dark:bg-rose-900/20 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(C,{size:32})}),e.jsx("h3",{className:"text-xl font-bold dark:text-white mb-2",children:"Select PDF"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to start converting"})]}),e.jsx(H,{})]})}export{ie as default};
