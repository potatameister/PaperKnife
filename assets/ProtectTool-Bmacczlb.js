import{a as G,j as t,d as z,t as I,e as W}from"./index-vG0bn-q0.js";import{h as M,r as F}from"./utilities-8Xav_QdM.js";import{e as Y,P as T}from"./pdf-core-B42Ge-vd.js";import{u as J,g as Q}from"./pdfHelpers-quNdLaSm.js";import{T as X,L as Z,P as K}from"./PrivacyBadge-2XgPbjSP.js";import{S as ee}from"./SuccessState-BxUCUFo3.js";import"./pdf-viewer-DFtpL4X_.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=G("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),se=M(Y);/**
 * pdf-encrypt-lite - Ultra-lightweight PDF encryption library
 * Powers PDFSmaller.com's PDF encryption tool
 * 
 * @author PDFSmaller.com (https://pdfsmaller.com)
 * @license MIT
 * @see https://pdfsmaller.com/protect-pdf - Try it online!
 * 
 * This minimal cryptographic implementation was built to solve the "impossible" 
 * problem of real PDF encryption within Cloudflare Workers' 1MB limit.
 * Total size: ~7KB for complete PDF encryption!
 */function re(o){const e=typeof o=="string"?new TextEncoder().encode(o):o,a=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],s=new Uint32Array([3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745]);let c=1732584193,r=4023233417,i=2562383102,l=271733878;const u=e.length,b=u*8,f=u+9+63&-64,p=new Uint8Array(f);p.set(e),p[u]=128;const v=new DataView(p.buffer);v.setUint32(f-8,b,!0),v.setUint32(f-4,0,!0);for(let P=0;P<f;P+=64){const g=new Uint32Array(p.buffer,P,16);let h=c,m=r,n=i,d=l;for(let x=0;x<64;x++){let w,j;x<16?(w=m&n|~m&d,j=x):x<32?(w=d&m|~d&n,j=(5*x+1)%16):x<48?(w=m^n^d,j=(3*x+5)%16):(w=n^(m|~d),j=7*x%16),w=w+h+s[x]+g[j]>>>0,h=d,d=n,n=m,m=m+(w<<a[x]|w>>>32-a[x])>>>0}c=c+h>>>0,r=r+m>>>0,i=i+n>>>0,l=l+d>>>0}const k=new Uint8Array(16),y=new DataView(k.buffer);return y.setUint32(0,c,!0),y.setUint32(4,r,!0),y.setUint32(8,i,!0),y.setUint32(12,l,!0),k}let ae=class{constructor(e){this.s=new Uint8Array(256),this.i=0,this.j=0;for(let s=0;s<256;s++)this.s[s]=s;let a=0;for(let s=0;s<256;s++)a=a+this.s[s]+e[s%e.length]&255,[this.s[s],this.s[a]]=[this.s[a],this.s[s]]}process(e){const a=new Uint8Array(e.length);for(let s=0;s<e.length;s++){this.i=this.i+1&255,this.j=this.j+this.s[this.i]&255,[this.s[this.i],this.s[this.j]]=[this.s[this.j],this.s[this.i]];const c=this.s[this.i]+this.s[this.j]&255;a[s]=e[s]^this.s[c]}return a}};function ne(o){const e=new Uint8Array(o.length/2);for(let a=0;a<e.length;a++)e[a]=parseInt(o.substr(a*2,2),16);return e}function oe(o){return Array.from(o).map(e=>e.toString(16).padStart(2,"0")).join("")}const ce=Object.freeze(Object.defineProperty({__proto__:null,RC4:ae,bytesToHex:oe,hexToBytes:ne,md5:re},Symbol.toStringTag,{value:"Module"})),ie=M(ce);/**
 * pdf-encrypt-lite - Ultra-lightweight PDF encryption library
 * Powers PDFSmaller.com's PDF encryption tool
 * 
 * @author PDFSmaller.com (https://pdfsmaller.com)
 * @license MIT
 * @see https://pdfsmaller.com/protect-pdf - Try it online!
 * 
 * This module implements PDF Standard Security Handler (Algorithm 2 & 3 from PDF spec)
 * Built to solve the "impossible" problem of real PDF encryption within edge constraints
 * 
 * Total size with crypto: ~7KB - when others are 2-20MB!
 * Battle-tested on thousands of PDFs at PDFSmaller.com
 */const{PDFDocument:le,PDFName:O,PDFHexString:D,PDFString:de,PDFDict:H,PDFArray:xe,PDFRawStream:fe,PDFNumber:U}=se,{md5:S,RC4:C,hexToBytes:V,bytesToHex:N}=ie,A=new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]);function E(o){const e=new TextEncoder().encode(o),a=new Uint8Array(32);return e.length>=32?a.set(e.slice(0,32)):(a.set(e),a.set(A.slice(0,32-e.length),e.length)),a}function ue(o,e,a,s){const c=E(o),r=new Uint8Array(c.length+e.length+4+s.length);let i=0;r.set(c,i),i+=c.length,r.set(e,i),i+=e.length,r[i++]=a&255,r[i++]=a>>8&255,r[i++]=a>>16&255,r[i++]=a>>24&255,r.set(s,i);let l=S(r);for(let u=0;u<50;u++)l=S(l.slice(0,16));return l.slice(0,16)}function he(o,e){const a=E(o||e);let s=S(a);for(let i=0;i<50;i++)s=S(s);const c=E(e);let r=new Uint8Array(c);for(let i=0;i<20;i++){const l=new Uint8Array(s.length);for(let b=0;b<s.length;b++)l[b]=s[b]^i;r=new C(l.slice(0,16)).process(r)}return r}function me(o,e){const a=new Uint8Array(A.length+e.length);a.set(A),a.set(e,A.length);const s=S(a);let r=new C(o).process(s);for(let l=1;l<=19;l++){const u=new Uint8Array(o.length);for(let f=0;f<o.length;f++)u[f]=o[f]^l;r=new C(u).process(r)}const i=new Uint8Array(32);return i.set(r),i.set(new Uint8Array(16),16),i}function B(o,e,a,s){const c=new Uint8Array(s.length+5);c.set(s),c[s.length]=e&255,c[s.length+1]=e>>8&255,c[s.length+2]=e>>16&255,c[s.length+3]=a&255,c[s.length+4]=a>>8&255;const r=S(c);return new C(r.slice(0,Math.min(s.length+5,16))).process(o)}function $(o,e,a,s){if(o){if(o instanceof de){const c=o.asBytes(),r=B(c,e,a,s);o.value=N(r)}else if(o instanceof D){const c=V(o.asString()),r=B(c,e,a,s);o.value=N(r)}else if(o instanceof H){const c=o.entries();for(const[r,i]of c){const l=r.asString();l!=="/Length"&&l!=="/Filter"&&l!=="/DecodeParms"&&$(i,e,a,s)}}else if(o instanceof xe){const c=o.asArray();for(const r of c)$(r,e,a,s)}}}async function be(o,e,a=null){try{const s=await le.load(o,{ignoreEncryption:!0,updateMetadata:!1}),c=s.context;let r;const i=c.trailerInfo,l=i.ID;if(l&&Array.isArray(l)&&l.length>0){const h=l[0].toString().replace(/^<|>$/g,"");r=V(h)}else{const g=new Uint8Array(16);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(g);else for(let n=0;n<16;n++)g[n]=Math.floor(Math.random()*256);r=g;const h=D.of(N(r)),m=D.of(N(r));i.ID=[h,m]}const u=4294967292,b=he(a,e),f=ue(e,b,u,r),p=me(f,r),v=c.enumerateIndirectObjects();for(const[g,h]of v){const m=g.objectNumber,n=g.generationNumber||0;if(h instanceof H){const d=h.get(O.of("Filter"));if(d&&d.asString()==="/Standard")continue}if(h instanceof fe){const d=h.contents,x=B(d,m,n,f);h.contents=x}$(h,m,n,f)}const k=c.obj({Filter:O.of("Standard"),V:U.of(2),R:U.of(3),Length:U.of(128),P:U.of(u),O:D.of(N(b)),U:D.of(N(p))}),y=c.register(k);return i.Encrypt=y,await s.save({useObjectStreams:!1})}catch(s){throw console.error("PDF encryption error:",s),new Error(`Failed to encrypt PDF: ${s.message}`)}}var pe=be;function Ne(){const o=F.useRef(null),[e,a]=F.useState(null),[s,c]=F.useState(!1),[r,i]=F.useState(""),[l,u]=F.useState(""),[b,f]=F.useState(null),[p,v]=F.useState(""),[k,y]=F.useState("paperknife-protected"),P=async()=>{if(!e||!p)return;c(!0);const n=await J(e.file,p);n.success?(a({...e,isLocked:!1,thumbnail:n.thumbnail,pageCount:n.pageCount,sourcePassword:p}),y(`${e.file.name.replace(".pdf","")}-protected`)):I.error("Incorrect password"),c(!1)},g=async n=>{if(n.type!=="application/pdf")return;const d=await Q(n);a({file:n,thumbnail:d.thumbnail,pageCount:d.pageCount,isLocked:d.isLocked}),y(`${n.name.replace(".pdf","")}-protected`),f(null)},h=n=>{var d;(d=n.target.files)!=null&&d[0]&&g(n.target.files[0])},m=async()=>{if(!(!e||!r||r!==l)){c(!0),await new Promise(n=>setTimeout(n,100));try{const n=await e.file.arrayBuffer(),d=await T.load(n,{password:e.sourcePassword||void 0,ignoreEncryption:!0}),x=await T.create();(await x.copyPages(d,d.getPageIndices())).forEach(q=>x.addPage(q));const j=await x.save(),_=await pe(j,r),L=new Blob([_],{type:"application/pdf"}),R=URL.createObjectURL(L);f(R),W({name:`${k||"protected"}.pdf`,tool:"Protect",size:L.size,resultUrl:R})}catch(n){console.error("Protect Error:",n),I.error(`Failed to protect PDF: ${n.message}`)}finally{c(!1)}}};return t.jsx("div",{className:"flex-1",children:t.jsxs("main",{className:"max-w-4xl mx-auto px-6 py-6 md:py-10",children:[t.jsx(X,{title:"Secure Your",highlight:"Data",description:"Add a strong password to your PDF document. Everything stays on your device."}),t.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:o,onChange:h}),e?e.isLocked?t.jsx("div",{className:"max-w-md mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500",children:t.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-xl text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx(z,{size:32})}),t.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"File is Protected"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 mb-8",children:"Unlock this file to re-protect it with a new password."}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("input",{type:"password",value:p,onChange:n=>v(n.target.value),placeholder:"Current Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold text-center transition-all",autoFocus:!0}),t.jsx("button",{onClick:P,disabled:!p||s,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all active:scale-95 disabled:opacity-50",children:s?"Unlocking...":"Unlock PDF"}),t.jsx("button",{onClick:()=>a(null),className:"w-full py-2 text-xs font-bold text-gray-400 hover:text-rose-500",children:"Choose different file"})]})]})}):t.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-3xl border border-gray-100 dark:border-zinc-800 shadow-sm flex items-center gap-6",children:[t.jsx("div",{className:"w-20 h-28 bg-gray-100 dark:bg-zinc-800 rounded-xl overflow-hidden shrink-0 border border-gray-200 dark:border-zinc-700 text-rose-500",children:e.thumbnail?t.jsx("img",{src:e.thumbnail,alt:"Preview",className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx(z,{size:24})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-bold text-lg truncate dark:text-white",children:e.file.name}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:[e.pageCount," Pages • ",(e.file.size/(1024*1024)).toFixed(2)," MB"]}),t.jsx("button",{onClick:()=>a(null),className:"mt-2 text-xs font-black uppercase text-rose-500 hover:text-rose-600 transition-colors",children:"Change File"})]})]}),t.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-3xl border border-gray-100 dark:border-zinc-800 shadow-sm space-y-6",children:[b?t.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:t.jsx(ee,{message:"Encrypted Successfully",downloadUrl:b,fileName:`${k||"protected"}.pdf`,onStartOver:()=>{f(null),i(""),u("")}})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3",children:"Set Password"}),t.jsx("input",{type:"password",value:r,onChange:n=>i(n.target.value),className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold transition-colors",placeholder:"••••••••"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3",children:"Confirm Password"}),t.jsx("input",{type:"password",value:l,onChange:n=>u(n.target.value),className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold transition-colors",placeholder:"••••••••"})]})]}),r&&l&&r!==l&&t.jsx("p",{className:"text-xs text-rose-500 font-bold",children:"Passwords do not match."}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3",children:"Output Filename"}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus-within:border-rose-500 transition-colors",children:[t.jsx("input",{type:"text",value:k,onChange:n=>y(n.target.value),className:"bg-transparent outline-none flex-1 text-sm font-bold dark:text-white"}),t.jsx("span",{className:"text-gray-400 text-xs font-bold",children:".pdf"})]})]}),t.jsx("button",{onClick:m,disabled:s||!r||r!==l,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-6 rounded-3xl shadow-xl shadow-rose-200 dark:shadow-none font-black text-xl tracking-tight transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3",children:s?t.jsxs(t.Fragment,{children:[t.jsx(Z,{className:"animate-spin"})," Securing..."]}):"Encrypt & Save PDF"})]}),t.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-2xl border border-amber-100 dark:border-amber-900/30 flex items-start gap-3",children:[t.jsx(z,{size:16,className:"text-amber-600 shrink-0 mt-0.5"}),t.jsxs("p",{className:"text-[10px] md:text-xs text-amber-700 dark:text-amber-400 leading-relaxed",children:[t.jsx("strong",{children:"Warning:"})," PaperKnife cannot recover forgotten passwords. Make sure to save your password in a secure place."]})]})]})]}):t.jsxs("div",{onClick:()=>{var n;return(n=o.current)==null?void 0:n.click()},className:"border-4 border-dashed border-gray-200 dark:border-zinc-800 rounded-[2rem] md:rounded-[2.5rem] bg-white/50 dark:bg-zinc-900/50 p-10 md:p-20 text-center hover:border-rose-300 dark:hover:border-rose-900 hover:bg-rose-50/50 dark:hover:bg-rose-900/10 transition-all cursor-pointer group",children:[t.jsx("div",{className:"w-16 h-16 md:w-24 md:h-24 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-4 md:mb-6 group-hover:scale-110 transition-transform",children:t.jsx(te,{size:32,className:"md:w-[40px] md:h-[40px]"})}),t.jsx("h3",{className:"text-xl md:text-2xl font-bold mb-1 md:mb-2 group-hover:text-rose-600 dark:group-hover:text-rose-400 transition-colors",children:"Select PDF to Protect"}),t.jsx("p",{className:"text-xs md:text-sm text-gray-400 dark:text-zinc-500",children:"Tap to browse your files"})]}),t.jsx(K,{})]})})}export{Ne as default};
