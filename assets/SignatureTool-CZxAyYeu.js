import{c as X,j as e,T as H,D as J,t as f,b as W}from"./index-BzPALJtm.js";import{r as n}from"./utilities-DaVU6ayd.js";import{P as q}from"./pdf-core-gCM2Eau9.js";import{L as K,u as Q,g as V,l as Z,r as _}from"./pdfHelpers-Ch3JphJG.js";import{T as ee,L,P as se}from"./PrivacyBadge-ChZsjFUQ.js";import{S as te}from"./SuccessState-CI9Gj7XO.js";import{I as ae}from"./image-Xgj-t2yk.js";import"./pdf-viewer-DFtpL4X_.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=X("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);function xe(){const y=n.useRef(null),w=n.useRef(null),[a,u]=n.useState(null),[i,h]=n.useState(null),[b,j]=n.useState(null),[p,l]=n.useState(!1),[k,N]=n.useState(null),v="paperknife-signed",[g,F]=n.useState(""),[c,P]=n.useState(1),[x,I]=n.useState({x:50,y:50}),[d,T]=n.useState(150),[S,R]=n.useState(null),B=async()=>{if(!a||!g)return;l(!0);const s=await Q(a.file,g);s.success?(u({...a,isLocked:!1,pageCount:s.pageCount,pdfDoc:s.pdfDoc,password:g}),m(s.pdfDoc,1)):f.error("Incorrect password"),l(!1)},$=async s=>{if(s.type==="application/pdf"){l(!0);try{const t=await V(s);if(t.isLocked)u({file:s,pageCount:0,isLocked:!0});else{const r=await Z(s);u({file:s,pageCount:t.pageCount,isLocked:!1,pdfDoc:r}),m(r,1)}}catch(t){console.error(t)}finally{l(!1)}}},m=async(s,t)=>{const r=await _(s,t);R(r)},E=s=>{var r;const t=(r=s.target.files)==null?void 0:r[0];t&&t.type.startsWith("image/")?(j(t),h(URL.createObjectURL(t))):f.error("Please upload a transparent PNG signature")},M=async()=>{if(!(!a||!b)){l(!0),await new Promise(s=>setTimeout(s,100));try{const s=await a.file.arrayBuffer(),t=await q.load(s,{password:a.password||void 0,ignoreEncryption:!0}),r=await b.arrayBuffer();let o;b.type==="image/png"?o=await t.embedPng(r):o=await t.embedJpg(r);const z=t.getPages()[c-1],{width:G,height:C}=z.getSize(),O=x.x/100*G,Y=C-x.y/100*C-d*(o.height/o.width);z.drawImage(o,{x:O,y:Y,width:d,height:d*(o.height/o.width)});const A=await t.save(),D=new Blob([A],{type:"application/pdf"}),U=URL.createObjectURL(D);N(U),W({name:`${v}.pdf`,tool:"Signature",size:D.size,resultUrl:U}),f.success("PDF signed successfully!")}catch(s){f.error(`Error signing PDF: ${s.message}`)}finally{l(!1)}}};return e.jsx("div",{className:"flex-1",children:e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-6 md:py-10",children:[e.jsx(ee,{title:"Electronic",highlight:"Signature",description:"Sign any PDF document securely. Upload a transparent PNG of your signature."}),e.jsx("input",{type:"file",accept:".pdf",className:"hidden",ref:y,onChange:s=>{var t;return((t=s.target.files)==null?void 0:t[0])&&$(s.target.files[0])}}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:w,onChange:E}),a?a.isLocked?e.jsx("div",{className:"max-w-md mx-auto animate-in fade-in duration-500",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(K,{size:32})}),e.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:"File is Protected"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 mb-8",children:"Unlock this file to sign it."}),e.jsx("input",{type:"password",value:g,onChange:s=>F(s.target.value),placeholder:"Enter Password",className:"w-full bg-gray-50 dark:bg-black rounded-2xl px-6 py-4 border border-gray-100 dark:border-zinc-800 focus:border-rose-500 outline-none font-bold text-center mb-4"}),e.jsx("button",{onClick:B,className:"w-full bg-rose-500 text-white p-4 rounded-2xl font-black uppercase tracking-widest text-xs",children:"Unlock PDF"})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in duration-500",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-4 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-sm relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400",children:["Page ",c," of ",a.pageCount]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:c<=1,onClick:()=>{P(s=>s-1),m(a.pdfDoc,c-1)},className:"px-3 py-1 bg-gray-100 dark:bg-zinc-800 rounded-lg text-[10px] font-bold disabled:opacity-30",children:"Prev"}),e.jsx("button",{disabled:c>=a.pageCount,onClick:()=>{P(s=>s+1),m(a.pdfDoc,c+1)},className:"px-3 py-1 bg-gray-100 dark:bg-zinc-800 rounded-lg text-[10px] font-bold disabled:opacity-30",children:"Next"})]})]}),e.jsxs("div",{className:"relative aspect-[1/1.4] w-full bg-gray-100 dark:bg-black rounded-xl overflow-hidden cursor-crosshair group",onClick:s=>{if(!i)return;const t=s.currentTarget.getBoundingClientRect(),r=(s.clientX-t.left)/t.width*100,o=(s.clientY-t.top)/t.height*100;I({x:r,y:o})},children:[S?e.jsx("img",{src:S,className:"w-full h-full object-contain",alt:"PDF Page"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center animate-pulse",children:e.jsx(L,{className:"animate-spin text-rose-500"})}),i&&e.jsx("div",{style:{left:`${x.x}%`,top:`${x.y}%`,width:`${d}px`,transform:"translate(-50%, -50%)"},className:"absolute pointer-events-none ring-2 ring-rose-500 ring-offset-2 rounded-sm shadow-2xl transition-all duration-75",children:e.jsx("img",{src:i,className:"w-full h-auto",alt:"Signature"})}),!i&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("p",{className:"bg-white dark:bg-zinc-900 px-4 py-2 rounded-full shadow-lg text-xs font-bold",children:"Upload signature first"})})]}),e.jsx("p",{className:"text-[10px] text-center text-gray-400 mt-4 font-medium italic",children:"Click anywhere on the document to place your signature."})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-[2.5rem] border border-gray-100 dark:border-zinc-800 shadow-sm sticky top-24",children:[k?e.jsx(te,{message:"Document Signed!",downloadUrl:k,fileName:`${v}.pdf`,onStartOver:()=>{N(null),h(null),u(null)}}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-4",children:"1. Your Signature"}),i?e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-full p-4 bg-gray-50 dark:bg-black rounded-2xl border border-gray-100 dark:border-zinc-800",children:e.jsx("img",{src:i,className:"h-20 mx-auto object-contain",alt:"Uploaded sig"})}),e.jsx("button",{onClick:()=>{h(null),j(null)},className:"absolute -top-2 -right-2 bg-rose-500 text-white p-1.5 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(H,{size:14})})]}):e.jsxs("button",{onClick:()=>{var s;return(s=w.current)==null?void 0:s.click()},className:"w-full aspect-video bg-rose-50 dark:bg-rose-900/10 border-2 border-dashed border-rose-200 dark:border-rose-900/30 rounded-2xl flex flex-col items-center justify-center gap-2 text-rose-500 hover:bg-rose-100 transition-all",children:[e.jsx(ae,{size:24}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Upload PNG"})]})]}),i&&e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-top-2 duration-300",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3 flex justify-between",children:[e.jsx("span",{children:"Signature Size"}),e.jsxs("span",{className:"text-rose-500",children:[d,"px"]})]}),e.jsx("input",{type:"range",min:"50",max:"400",step:"5",value:d,onChange:s=>T(parseInt(s.target.value)),className:"w-full accent-rose-500"})]}),e.jsxs("button",{onClick:M,disabled:p,className:"w-full bg-rose-500 hover:bg-rose-600 text-white p-6 rounded-3xl shadow-xl shadow-rose-200 dark:shadow-none font-black text-xl tracking-tight transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3",children:[p?e.jsx(L,{className:"animate-spin"}):e.jsx(J,{}),"Save Signed PDF"]})]})]}),e.jsx("button",{onClick:()=>u(null),className:"w-full mt-6 py-2 text-[10px] font-black uppercase text-gray-300 hover:text-rose-500 transition-colors tracking-[0.2em]",children:"Cancel"})]})})]}):e.jsxs("div",{onClick:()=>{var s;return!p&&((s=y.current)==null?void 0:s.click())},className:`border-4 border-dashed border-gray-200 dark:border-zinc-800 rounded-[2.5rem] bg-white/50 dark:bg-zinc-900/50 p-20 text-center hover:border-rose-300 dark:hover:border-rose-900 transition-all cursor-pointer group ${p?"opacity-50":""}`,children:[e.jsx("div",{className:"w-24 h-24 bg-rose-100 dark:bg-rose-900/30 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:e.jsx(re,{size:40})}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Select PDF to Sign"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tap to browse your files"})]}),e.jsx(se,{})]})})}export{xe as default};
